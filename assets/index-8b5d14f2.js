var _t=Object.defineProperty;var xt=(e,t,n)=>t in e?_t(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var O=(e,t,n)=>(xt(e,typeof t!="symbol"?t+"":t,n),n);import{R as _e,d as j,k as h,S as Y,U as bt,V as yt,W as wt,L as Ae,r as w,X as kt,D as K,J as Ct,Y as It,s as oe,Z as me,o as xe,$ as Ge,a0 as je,H as Pe,l as pe,a1 as St,a2 as Lt,a3 as Tt,a4 as $t,a5 as Mt,a6 as Bt,a7 as Vt,a8 as Ne,a as y,c as L,w as Q,h as p,u as c,p as le,v as ie,m as re,_ as se,F as q,i as Z,b as be,n as ce,t as H,j as ge,g as Je,K as Ye,q as At}from"./index-54672c58.js";import{c as ye,m as te,n as G,a as Ke,u as ne,r as Dt,d as Pt,I as ue,w as we,f as Et,s as Ot,h as Ze,F as Rt,i as ve,j as Xe,k as Ft,p as Ce,l as jt,L as Nt,o as zt,q as Ht,g as U,P as Qe,v as Ut,t as he,x as De,y as Ie,z as Wt,e as ze}from"./index-f79d2a50.js";import{u as et,T as qt,a as Gt}from"./index-239eccc1.js";import{_ as Jt,a as Yt}from"./ContactButton.vue_vue_type_script_setup_true_lang-45d7be59.js";import{l as tt,g as Kt,s as Zt,c as Xt,I as nt,a as Qt,r as en,b as tn}from"./AppArouse-d68d8296.js";import{d as nn}from"./index-bd6ad598.js";import"./shared.esm-bundler-d713a4fb.js";const[on,ae]=ye("cell"),ot={tag:te("div"),icon:String,size:String,title:G,value:G,label:G,center:Boolean,isLink:Boolean,border:Ke,required:Boolean,iconPrefix:String,valueClass:ne,labelClass:ne,titleClass:ne,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},sn=_e({},ot,Dt);var an=j({name:on,props:sn,setup(e,{slots:t}){const n=Pt(),s=()=>{if(t.label||Y(e.label))return h("div",{class:[ae("label"),e.labelClass]},[t.label?t.label():e.label])},a=()=>{var i;if(t.title||Y(e.title)){const m=(i=t.title)==null?void 0:i.call(t);return Array.isArray(m)&&m.length===0?void 0:h("div",{class:[ae("title"),e.titleClass],style:e.titleStyle},[m||h("span",null,[e.title]),s()])}},l=()=>{const i=t.value||t.default;if(i||Y(e.value))return h("div",{class:[ae("value"),e.valueClass]},[i?i():h("span",null,[e.value])])},u=()=>{if(t.icon)return t.icon();if(e.icon)return h(ue,{name:e.icon,class:ae("left-icon"),classPrefix:e.iconPrefix},null)},f=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const i=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return h(ue,{name:i,class:ae("right-icon")},null)}};return()=>{var i;const{tag:m,size:r,center:v,border:C,isLink:_,required:x}=e,T=(i=e.clickable)!=null?i:_,V={center:v,required:x,clickable:T,borderless:!C};return r&&(V[r]=!!r),h(m,{class:ae(V),role:T?"button":void 0,tabindex:T?0:void 0,onClick:n},{default:()=>{var $;return[u(),a(),l(),f(),($=t.extra)==null?void 0:$.call(t)]}})}}});const ln=we(an);function st(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function rn(e,t){if(st(e)){if(t.required)return!1;if(t.validateEmpty===!1)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}function cn(e,t){return new Promise(n=>{const s=t.validator(e,t);if(bt(s)){s.then(n);return}n(s)})}function He(e,t){const{message:n}=t;return yt(n)?n(e,t):n||""}function un({target:e}){e.composing=!0}function Ue({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function dn(e,t){const n=Et();e.style.height="auto";let s=e.scrollHeight;if(wt(t)){const{maxHeight:a,minHeight:l}=t;a!==void 0&&(s=Math.min(s,a)),l!==void 0&&(s=Math.max(s,l))}s&&(e.style.height=`${s}px`,Ot(n))}function fn(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function J(e){return[...e].length}function Se(e,t){return[...e].slice(0,t).join("")}const[mn,z]=ye("field"),Ee={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:G,formatter:Function,clearIcon:te("clear"),modelValue:Ze(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,spellcheck:{type:Boolean,default:null},clearTrigger:te("focus"),formatTrigger:te("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},hn=_e({},ot,Ee,{rows:G,type:te("text"),rules:Array,autosize:[Boolean,Object],labelWidth:G,labelClass:ne,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var pn=j({name:mn,props:hn,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:n}){const s=et(),a=Ae({status:"unvalidated",focused:!1,validateMessage:""}),l=w(),u=w(),f=w(),{parent:i}=kt(Rt),m=()=>{var o;return String((o=e.modelValue)!=null?o:"")},r=o=>{if(Y(e[o]))return e[o];if(i&&Y(i.props[o]))return i.props[o]},v=K(()=>{const o=r("readonly");if(e.clearable&&!o){const S=m()!=="",I=e.clearTrigger==="always"||e.clearTrigger==="focus"&&a.focused;return S&&I}return!1}),C=K(()=>f.value&&n.input?f.value():e.modelValue),_=o=>o.reduce((S,I)=>S.then(()=>{if(a.status==="failed")return;let{value:A}=C;if(I.formatter&&(A=I.formatter(A,I)),!rn(A,I)){a.status="failed",a.validateMessage=He(A,I);return}if(I.validator)return st(A)&&I.validateEmpty===!1?void 0:cn(A,I).then(E=>{E&&typeof E=="string"?(a.status="failed",a.validateMessage=E):E===!1&&(a.status="failed",a.validateMessage=He(A,I))})}),Promise.resolve()),x=()=>{a.status="unvalidated",a.validateMessage=""},T=()=>t("endValidate",{status:a.status,message:a.validateMessage}),V=(o=e.rules)=>new Promise(S=>{x(),o?(t("startValidate"),_(o).then(()=>{a.status==="failed"?(S({name:e.name,message:a.validateMessage}),T()):(a.status="passed",S(),T())})):S()}),$=o=>{if(i&&e.rules){const{validateTrigger:S}=i.props,I=je(S).includes(o),A=e.rules.filter(E=>E.trigger?je(E.trigger).includes(o):I);A.length&&V(A)}},D=o=>{var S;const{maxlength:I}=e;if(Y(I)&&J(o)>+I){const A=m();if(A&&J(A)===+I)return A;const E=(S=l.value)==null?void 0:S.selectionEnd;if(a.focused&&E){const F=[...o],W=F.length-+I;return F.splice(E-W,W),F.join("")}return Se(o,+I)}return o},M=(o,S="onChange")=>{const I=o;o=D(o);const A=J(I)-J(o);if(e.type==="number"||e.type==="digit"){const F=e.type==="number";o=Ft(o,F,F)}let E=0;if(e.formatter&&S===e.formatTrigger){const{formatter:F,maxlength:W}=e;if(o=F(o),Y(W)&&J(o)>+W&&(o=Se(o,+W)),l.value&&a.focused){const{selectionEnd:ke}=l.value,Fe=Se(I,ke);E=J(F(Fe))-J(Fe)}}if(l.value&&l.value.value!==o)if(a.focused){let{selectionStart:F,selectionEnd:W}=l.value;if(l.value.value=o,Y(F)&&Y(W)){const ke=J(o);A?(F-=A,W-=A):E&&(F+=E,W+=E),l.value.setSelectionRange(Math.min(F,ke),Math.min(W,ke))}}else l.value.value=o;o!==e.modelValue&&t("update:modelValue",o)},ee=o=>{o.target.composing||M(o.target.value)},d=()=>{var o;return(o=l.value)==null?void 0:o.blur()},k=()=>{var o;return(o=l.value)==null?void 0:o.focus()},R=()=>{const o=l.value;e.type==="textarea"&&e.autosize&&o&&dn(o,e.autosize)},b=o=>{a.focused=!0,t("focus",o),me(R),r("readonly")&&d()},B=o=>{a.focused=!1,M(m(),"onBlur"),t("blur",o),!r("readonly")&&($("onBlur"),me(R),jt())},P=o=>t("clickInput",o),g=o=>t("clickLeftIcon",o),N=o=>t("clickRightIcon",o),de=o=>{Ce(o),t("update:modelValue",""),t("clear",o)},Oe=K(()=>{if(typeof e.error=="boolean")return e.error;if(i&&i.props.showError&&a.status==="failed")return!0}),rt=K(()=>{const o=r("labelWidth"),S=r("labelAlign");if(o&&S!=="top")return{width:ve(o)}}),ct=o=>{o.keyCode===13&&(!(i&&i.props.submitOnEnter)&&e.type!=="textarea"&&Ce(o),e.type==="search"&&d()),t("keypress",o)},Re=()=>e.id||`${s}-input`,ut=()=>a.status,dt=()=>{const o=z("control",[r("inputAlign"),{error:Oe.value,custom:!!n.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(n.input)return h("div",{class:o,onClick:P},[n.input()]);const S={id:Re(),ref:l,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:o,disabled:r("disabled"),readonly:r("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${s}-label`:void 0,onBlur:B,onFocus:b,onInput:ee,onClick:P,onChange:Ue,onKeypress:ct,onCompositionend:Ue,onCompositionstart:un};return e.type==="textarea"?h("textarea",S,null):h("input",Pe(fn(e.type),S),null)},ft=()=>{const o=n["left-icon"];if(e.leftIcon||o)return h("div",{class:z("left-icon"),onClick:g},[o?o():h(ue,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},mt=()=>{const o=n["right-icon"];if(e.rightIcon||o)return h("div",{class:z("right-icon"),onClick:N},[o?o():h(ue,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},ht=()=>{if(e.showWordLimit&&e.maxlength){const o=J(m());return h("div",{class:z("word-limit")},[h("span",{class:z("word-num")},[o]),pe("/"),e.maxlength])}},pt=()=>{if(i&&i.props.showErrorMessage===!1)return;const o=e.errorMessage||a.validateMessage;if(o){const S=n["error-message"],I=r("errorMessageAlign");return h("div",{class:z("error-message",I)},[S?S({message:o}):o])}},gt=()=>{const o=r("labelWidth"),S=r("labelAlign"),I=r("colon")?":":"";if(n.label)return[n.label(),I];if(e.label)return h("label",{id:`${s}-label`,for:n.input?void 0:Re(),onClick:A=>{Ce(A),k()},style:S==="top"&&o?{width:ve(o)}:void 0},[e.label+I])},vt=()=>[h("div",{class:z("body")},[dt(),v.value&&h(ue,{ref:u,name:e.clearIcon,class:z("clear")},null),mt(),n.button&&h("div",{class:z("button")},[n.button()])]),ht(),pt()];return Xe({blur:d,focus:k,validate:V,formValue:C,resetValidation:x,getValidationStatus:ut}),Ct(It,{customValue:f,resetValidation:x,validateWithTrigger:$}),oe(()=>e.modelValue,()=>{M(m()),x(),$("onChange"),me(R)}),xe(()=>{M(m(),e.formatTrigger),me(R)}),Ge("touchstart",de,{target:K(()=>{var o;return(o=u.value)==null?void 0:o.$el})}),()=>{const o=r("disabled"),S=r("labelAlign"),I=ft(),A=()=>{const E=gt();return S==="top"?[I,E].filter(Boolean):E||[]};return h(ln,{size:e.size,class:z({error:Oe.value,disabled:o,[`label-${S}`]:S}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:rt.value,valueClass:z("value"),titleClass:[z("label",[S,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:I&&S!=="top"?()=>I:null,title:A,value:vt,extra:n.extra})}}});const gn=we(pn),[vn,Le]=ye("switch"),_n={size:G,loading:Boolean,disabled:Boolean,modelValue:ne,activeColor:String,inactiveColor:String,activeValue:{type:ne,default:!0},inactiveValue:{type:ne,default:!1}};var xn=j({name:vn,props:_n,emits:["change","update:modelValue"],setup(e,{emit:t,slots:n}){const s=()=>e.modelValue===e.activeValue,a=()=>{if(!e.disabled&&!e.loading){const u=s()?e.inactiveValue:e.activeValue;t("update:modelValue",u),t("change",u)}},l=()=>{if(e.loading){const u=s()?e.activeColor:e.inactiveColor;return h(Nt,{class:Le("loading"),color:u},null)}if(n.node)return n.node()};return St(()=>e.modelValue),()=>{var u;const{size:f,loading:i,disabled:m,activeColor:r,inactiveColor:v}=e,C=s(),_={fontSize:ve(f),backgroundColor:C?r:v};return h("div",{role:"switch",class:Le({on:C,loading:i,disabled:m}),style:_,tabindex:m?void 0:0,"aria-checked":C,onClick:a},[h("div",{class:Le("node")},[l()]),(u=n.background)==null?void 0:u.call(n)])}}});const bn=we(xn),[yn,Te]=ye("back-top"),wn={right:G,bottom:G,zIndex:G,target:[String,Object],offset:Ze(200),immediate:Boolean,teleport:{type:[String,Object],default:"body"}};var kn=j({name:yn,inheritAttrs:!1,props:wn,emits:["click"],setup(e,{emit:t,slots:n,attrs:s}){let a=!1;const l=w(!1),u=w(),f=w(),i=K(()=>_e(zt(e.zIndex),{right:ve(e.right),bottom:ve(e.bottom)})),m=_=>{var x;t("click",_),(x=f.value)==null||x.scrollTo({top:0,behavior:e.immediate?"auto":"smooth"})},r=()=>{l.value=f.value?Ht(f.value)>=+e.offset:!1},v=()=>{const{target:_}=e;if(typeof _=="string"){const x=document.querySelector(_);if(x)return x}else return _},C=()=>{Bt&&me(()=>{f.value=e.target?v():Vt(u.value),r()})};return Ge("scroll",Lt(r,100),{target:f}),xe(C),Tt(()=>{a&&(l.value=!0,a=!1)}),$t(()=>{l.value&&e.teleport&&(l.value=!1,a=!0)}),oe(()=>e.target,C),()=>{const _=h("div",Pe({ref:e.teleport?void 0:u,class:Te({active:l.value}),style:i.value,onClick:m},s),[n.default?n.default():h(ue,{name:"back-top",class:Te("icon")},null)]);return e.teleport?[h("div",{ref:u,class:Te("placeholder")},null),h(Mt,{to:e.teleport},{default:()=>[_]})]:_}}});const Cn=we(kn),[In,fe,Sn]=ye("search"),Ln=_e({},Ee,{label:String,shape:te("square"),leftIcon:te("search"),clearable:Ke,actionText:String,background:String,showAction:Boolean});var Tn=j({name:In,props:Ln,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:n,attrs:s}){const a=et(),l=w(),u=()=>{n.action||(t("update:modelValue",""),t("cancel"))},f=d=>{d.keyCode===13&&(Ce(d),t("search",e.modelValue))},i=()=>e.id||`${a}-input`,m=()=>{if(n.label||e.label)return h("label",{class:fe("label"),for:i()},[n.label?n.label():e.label])},r=()=>{if(e.showAction){const d=e.actionText||Sn("cancel");return h("div",{class:fe("action"),role:"button",tabindex:0,onClick:u},[n.action?n.action():d])}},v=()=>{var d;return(d=l.value)==null?void 0:d.blur()},C=()=>{var d;return(d=l.value)==null?void 0:d.focus()},_=d=>t("blur",d),x=d=>t("focus",d),T=d=>t("clear",d),V=d=>t("clickInput",d),$=d=>t("clickLeftIcon",d),D=d=>t("clickRightIcon",d),M=Object.keys(Ee),ee=()=>{const d=_e({},s,Ne(e,M),{id:i()}),k=R=>t("update:modelValue",R);return h(gn,Pe({ref:l,type:"search",class:fe("field"),border:!1,onBlur:_,onFocus:x,onClear:T,onKeypress:f,onClickInput:V,onClickLeftIcon:$,onClickRightIcon:D,"onUpdate:modelValue":k},d),Ne(n,["left-icon","right-icon"]))};return Xe({focus:C,blur:v}),()=>{var d;return h("div",{class:fe({"show-action":e.showAction}),style:{background:e.background}},[(d=n.left)==null?void 0:d.call(n),h("div",{class:fe("content",e.shape)},[m(),ee()]),r()])}}});const $n=we(Tn);const Mn=["src"],Bn=j({__name:"Search",emits:["search","focus","clear"],setup(e,{emit:t}){const n=w(),s=w(!1),a=t,l=()=>a("search",n.value),u=()=>{s.value=!0,a("focus")},f=()=>{n.value=null,a("clear")};return(i,m)=>{const r=$n;return y(),L("div",null,[h(r,{class:"search",modelValue:c(n),"onUpdate:modelValue":[m[0]||(m[0]=v=>re(n)?n.value=v:null),l],placeholder:"请输入搜索关键词",onSearch:l,onFocus:u},{"left-icon":Q(()=>[p("img",{class:"w-48px h-48px",src:c(U)("icon-search.png")},null,8,Mn)]),"right-icon":Q(()=>[le(p("div",{class:"text-#029AA7 text-30px",onClick:f}," 取消 ",512),[[ie,c(s)]])]),_:1},8,["modelValue"])])}}});const Vn=se(Bn,[["__scopeId","data-v-37cb3a94"]]),An={class:"bg-#fff"},Dn={class:"flex justify-between items-center border-t-1px border-#ddd px-68px py-18px"},Pn=["onClick"],En={key:0,class:"flex flex-col ml-8px"},On=["onClick","src"],Rn=j({__name:"classification",props:{markerType:{}},emits:["typeClick"],setup(e,{emit:t}){const n=e,s=w(0),a=w("zh"),l=w(""),u=w([{label:"综合",val:"zh"},{label:"更新时间",val:"gxsj"},{label:"金额",val:"je",list:[{img:"icon-je-up.png",imgActive:"icon-je-up-active.png",val:"up",fVal:"je"},{img:"icon-je-down.png",imgActive:"icon-je-down-active.png",val:"down",fVal:"je"}]}]),f=t,i=async({name:r})=>{const v=n.markerType.filter(C=>C.id==r)[0];f("typeClick",v)},m=r=>{r.val=="je"||r!=null&&r.fVal?(a.value=(r==null?void 0:r.fVal)??r.val,r.val=="je"?l.value=l.value=="up"?"down":"up":l.value=r.val):(l.value="",a.value=r.val)};return(r,v)=>{const C=Gt,_=qt;return y(),L("div",An,[h(_,{class:"tabs",active:c(s),"onUpdate:active":v[0]||(v[0]=x=>re(s)?s.value=x:null),"title-active-color":"#029AA7","title-inactive-color":"#888",onClickTab:i},{default:Q(()=>[(y(!0),L(q,null,Z(n.markerType,x=>(y(),be(C,{name:x.id,title:x.name,key:x.name},null,8,["name","title"]))),128))]),_:1},8,["active"]),p("div",Dn,[(y(!0),L(q,null,Z(c(u),x=>(y(),L("div",{class:"flex items-center",key:x.label},[p("span",{onClick:T=>m(x),class:ce(["text-24px",[c(a)==x.val?"text-#029AA7":"text-#888"]])},H(x.label),11,Pn),x.val=="je"?(y(),L("div",En,[(y(!0),L(q,null,Z(x.list,T=>(y(),L("img",{key:T.val,onClick:V=>m(T),class:"w-20px h-12px mb-4px",src:c(U)(c(l)==T.val?T.imgActive:T.img)},null,8,On))),128))])):ge("",!0)]))),128))])])}}});const Fn=se(Rn,[["__scopeId","data-v-4b23a777"]]),jn={class:"px-36px py-21px text-36px"},Nn=j({__name:"Popups",props:{position:{default:"bottom"},height:{default:"20%"},closeable:{type:Boolean,default:!0},round:{type:Boolean,default:!0},close:{type:Boolean,default:!1},lock:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},title:{default:"标题"},showPopup:{type:Boolean,default:!1}},emits:["update:showPopup"],setup(e,{emit:t}){const n=e,s=w(!1);oe(()=>n.showPopup,u=>{s.value=u});const a=t,l=()=>{a("update:showPopup",!1)};return(u,f)=>{const i=Qe;return y(),be(i,{class:"popups",show:c(s),"onUpdate:show":f[0]||(f[0]=m=>re(s)?s.value=m:null),position:n.position,closeable:n.closeable,round:n.round,"lock-scroll":n.lock,overlay:n.overlay,"close-on-click-overlay":n.close,style:Ye({height:n.height}),onClickCloseIcon:l},{default:Q(()=>[p("div",jn,H(n.title),1),f[1]||(f[1]=p("div",{class:"line"},null,-1)),Je(u.$slots,"default",{},void 0,!0)]),_:3},8,["show","position","closeable","round","lock-scroll","overlay","close-on-click-overlay","style"])}}});const zn=se(Nn,[["__scopeId","data-v-0f459506"]]);const $e=window.TMap;class at{constructor(t,n){O(this,"marker");O(this,"map");O(this,"geometries");this.map=t,this.geometries=[],this.initMarkerData(n)}initMarkerData(t){if(this.marker=new $e.MultiMarker({id:(t==null?void 0:t.markerLayerId)??"marker-layer",map:this.map}),t&&(t==null?void 0:t.markerLayerId)!=="marker-line")for(const n in t)this.update(t[n]);this.geometries=this.marker.geometries}update(t){const n=t.name||t.id;this.marker.styles.hasOwnProperty(n)||this.setStyle(t,n),this.marker.updateGeometries([{...t,position:new $e.LatLng(t.latitude,t.longitude),properties:{title:t.name},styleId:n,content:(t==null?void 0:t.needName)=="false"?"":t.name}])}setStyle(t,n){const s=this.marker.styles.default,a={anchor:{x:17,y:23},size:16,direction:"top",offset:{x:0,y:0},strokeColor:"#015E66",strokeWidth:12,...t},l=new $e.MarkerStyle({src:(t==null?void 0:t.icon)??s.src,width:42,height:48,color:"#fff",...a});this.marker.styles[n]=l}remove(t){t&&(this.marker.remove([t]),this.geometries=this.marker.geometries)}reset(){this.marker&&this.marker.setMap(null),this.marker=null,this.geometries=[]}}const Hn=window.TMap;class Un extends Hn.DOMOverlay{constructor(n){super(n);O(this,"content");O(this,"map");O(this,"position");this.map=n.map,this.content=n.content,this.position=n.position}onInit(n){this.content=n.content,this.position=n.position}onDestroy(){this.dom.removeEventListener("touchend",this.onTouchend),this.dom.removeEventListener("click",this.onClick),this.removeAllListeners()}onClick(){this.emit("click")}onTouchend(){this.emit("touchend")}createDOM(){const n=document.createElement("div");return n.classList.add("clusterBubble"),n.innerText=this.content,n.style.cssText=["width: 46px;","height: 52px;","line-height: 46px;"].join(" "),this.onClick=this.onClick.bind(this),n.addEventListener("click",this.onClick),this.onTouchend=this.onTouchend.bind(this),n.addEventListener("touchend",this.onTouchend),n}updateDOM(){if(!this.map)return;const n=this.map.projectToContainer(this.position),s=n.getX()-this.dom.clientWidth/2+"px",a=n.getY()-this.dom.clientHeight/2+"px";this.dom.style.transform=`translate(${s}, ${a})`,this.emit("dom_updated")}}const We=window.TMap;class Wn{constructor(t,n){O(this,"markerCluster");O(this,"map");O(this,"geometries");O(this,"clusterBubbleList");O(this,"markerGeometries");O(this,"marker");this.map=t,this.marker=n,this.geometries=[],this.clusterBubbleList=[],this.markerGeometries=[],this.initMarkerData(n.geometries)}initMarkerData(t){for(const n in t)this.geometries.push({...t[n],position:new We.LatLng(t[n].position.lat,t[n].position.lng)});this.markerCluster=new We.MarkerCluster({id:"markerCluster-layer",map:this.map,geometries:this.geometries,enableDefaultStyle:!1,minimumClusterSize:3,zoomOnClick:!0,gridSize:90,averageCenter:!1}),this.markerCluster.on("cluster_changed",()=>{this.clusterBubbleList.length&&(this.clusterBubbleList.forEach(function(s){s.destroy()}),this.clusterBubbleList=[]),this.markerGeometries=[],this.markerCluster.getClusters().forEach(s=>{if(s.geometries.length>2){const a=new Un({map:this.map,position:s.center,content:s.geometries.length});a.on("click",()=>{this.map.fitBounds(s.bounds)}),a.on("touchend",()=>{this.map.fitBounds(s.bounds)}),this.clusterBubbleList.push(a)}else this.markerGeometries.push({...s.geometries[0],styleId:s.geometries[0].name})}),this.marker.marker.setGeometries(this.markerGeometries)})}reset(){this.markerCluster&&this.markerCluster.setMap(null),this.markerCluster=null,this.clusterBubbleList.forEach(t=>{t.setMap(null)}),this.clusterBubbleList=[],this.geometries=[],this.marker=null,this.markerGeometries=[]}}const Me={};function Be(e,t){const n=new at(e,t??""),s=new Wn(e,n??"");return Me.marker=n,Me.markerCluster=s,Me}const lt=e=>{e.marker.reset(),e.markerCluster.reset()},Ve=window.TMap;class qn{constructor(t,n){O(this,"polyline");O(this,"map");O(this,"geometries");O(this,"editor");O(this,"defaultPolyline");this.map=t,this.geometries=[],this.initPolylineData(n)}initPolylineData(t){if(this.polyline=new Ve.MultiPolyline({id:"polyline-layer",map:this.map}),t)for(const n in t)this.update(t[n]);this.geometries=this.polyline.geometries}update(t){const n=this.polyline.styles.default;this.setStyle(t,n),this.polyline.updateGeometries([{...t,styleId:t.id,paths:this.pathsFormat(t.paths),position:t.paths[0]}])}setStyle(t,n){const s={width:parseInt(t.arrowW)||6,height:parseInt(t.arrowH)||4,space:parseInt(t.arrowS)||50},a=new Ve.PolylineStyle({color:t.color||n.color,width:parseInt(t.width)||n.width,borderColor:t.borderColor||n.borderColor,borderWidth:parseInt(t.borderWidth)||n.borderWidth,lineCap:t.lineCap||n.lineCap,dashArray:[t.dashArray,t.dashArray],showArrow:t.showArrow||n.showArrow,arrowOptions:s||n.arrowInfo,enableBloom:t.enableBloom||n.enableBloom});this.polyline.styles[t.id]=a}remove(t){t&&(this.polyline.remove([t]),this.geometries=this.polyline.geometries)}pathsFormat(t){const n=[];return t.forEach(s=>{n.push(new Ve.LatLng(s.lat,s.lng))}),n}reset(){this.polyline&&this.polyline.setMap(null),this.polyline=null,this.geometries=[]}}const Gn={class:"sht"},Jn={class:"tool-bar"},Yn={class:"tools"},Kn=["onClick"],Zn={key:0,class:"tjlx"},Xn=["onClick"],Qn={class:"flex items-center py-36px"},eo=["src"],to={class:"flex flex-col flex-1 overflow-hidden"},no={class:"text-#353535 text-30px"},oo={class:"w-100% text-#888 text-26px mt-px ellipsis"},so={key:0,class:"line"},ao={key:1,class:"flex justify-between mt-32px px-36px"},lo=["onClick"],io=["src"],ro={class:"mt-21px"},co=j({__name:"toolBar",emits:["showFooter","lineRoad"],setup(e,{expose:t,emit:n}){const s=w(!1),a=Ae({height:0,title:"",type:""}),l=w(),u=w(!1),f=w(!0),i=Ae({fg:"vector",lx:null}),m=w(!1),r=w([{label:"推荐线路",val:"tjlx",list:[]},{label:"图层风格",val:"tcfg",list:[{img:"img-pm.png",label:"平面地图",val:"vector"},{img:"img-wx.png",label:"卫星地图",val:"satellite"},{img:"img-qj.png",label:"全景地图",val:"vr",vrUrl:""}]},{label:"乡村简介",val:"xcjj"},{label:"分享页面",val:"fxym"}]);let v=tt.getCache("ruralInfo");const C=async()=>{const d=await Kt();r.value[0].list=d,r.value[1].list[2].vrUrl=v.vrUrl},_=d=>{if(s.value=!1,d.val=="fxym")m.value=!0;else if(d.val=="xcjj")he("ruralInfo");else switch(u.value=!0,a.type=d.val,a.title=d.label,l.value=d.list,d.val){case"tjlx":a.height="200px";break;default:a.height="168px"}},x=d=>{i.fg=d.val,d.val=="vr"?he("webView",d.vrUrl,!0):window.map.setBaseMap({type:d.val})},T=n;let V,$={};const D=async d=>{lt(window.mapPlugins),Object.keys($).length===0&&($.marker=new at(window.map,{markerLayerId:"marker-line"}),$.polyline=new qn(window.map,"")),Zt({message:"加载中...",forbidClick:!0,loadingType:"spinner"}),V&&await M(V,$),V=d.spot,i.lx=i.lx===d.id?null:d.id,i.lx&&await ee(d,$),Ie($,k=>T("lineRoad",k)),Xt()},M=async(d,k)=>{for(const R of d)await k.marker.remove(R.id);await k.polyline.remove("line")},ee=async(d,k)=>{const R=[];for(const b of d.spot)await k.marker.update({...b,needName:"false",icon:De(b.icon),latitude:b.latitude,longitude:b.longitude}),R.push({lat:b.latitude,lng:b.longitude});await k.polyline.update({...d,paths:R,id:"line",color:"#45a9f4",dashArray:10,width:5}),Wt(window.map,R)};return oe([u,m],d=>{const k=!!(d[0]||d[1]);!d[0]&&V&&(M(V,$),i.lx=null),T("showFooter",k,a.type)}),xe(async()=>{await C()}),t({showPopup:u}),(d,k)=>{const R=bn,b=nt,B=zn,P=Jt;return y(),L(q,null,[p("div",Gn,[h(R,{modelValue:c(f),"onUpdate:modelValue":k[0]||(k[0]=g=>re(f)?f.value=g:null),onClick:k[1]||(k[1]=g=>c(Ut)(c(f))),"active-color":"#029AA7","inactive-color":"#B2B2B2"},null,8,["modelValue"]),k[6]||(k[6]=p("span",{class:"mt-4px"},"手绘地图",-1))]),h(b,{class:"panorama",onClick:k[2]||(k[2]=g=>c(he)("webView",c(v).vrUrl,!0)),src:c(U)("icon_vr.png"),"lazy-load":""},null,8,["src"]),p("div",Jn,[le(p("div",Yn,[(y(!0),L(q,null,Z(c(r),(g,N)=>(y(),L("span",{onClick:de=>_(g),class:ce(["text-32px text-#fff",{"mb-41px":N<c(r).length-1}]),key:g.label},H(g.label),11,Kn))),128))],512),[[ie,c(s)]]),h(b,{onClick:k[3]||(k[3]=g=>s.value=!c(s)),class:"w-80px h-80px",src:c(U)("icon-tool.png"),"lazy-load":""},null,8,["src"]),c(a).type!=="fxym"?(y(),be(B,{key:0,height:c(a).height,title:c(a).title,lock:!1,overlay:!1,"show-popup":c(u),"onUpdate:showPopup":k[4]||(k[4]=g=>re(u)?u.value=g:null)},{default:Q(()=>[c(a).type=="tjlx"?(y(),L("div",Zn,[(y(!0),L(q,null,Z(c(l),(g,N)=>(y(),L("div",{class:ce(["px-33px",{"lx-active":c(i).lx==g.id}]),onClick:de=>D(g),key:g.id},[p("div",Qn,[p("img",{class:"w-84px h-84px mr-16px",src:c(De)(g.images)},null,8,eo),p("div",to,[p("span",no,H(g.name),1),p("span",oo,H(g.content),1)])]),N<c(l).length-1?(y(),L("div",so)):ge("",!0)],10,Xn))),128))])):(y(),L("div",ao,[(y(!0),L(q,null,Z(c(l),g=>(y(),L("div",{key:g.label,onClick:N=>x(g),class:ce([{tcfg:c(i).fg===g.val},"popup-text"])},[p("img",{class:"w-196px h-108px",src:c(U)(g.img)},null,8,io),p("span",ro,H(g.label),1)],10,lo))),128))]))]),_:1},8,["height","title","show-popup"])):ge("",!0)]),h(P,{"show-share":c(m),"onUpdate:showShare":k[5]||(k[5]=g=>re(m)?m.value=g:null)},null,8,["show-share"])],64)}}});const uo=se(co,[["__scopeId","data-v-c45a658c"]]),fo={class:"relative rounded-4px overflow-hidden"},mo=["src"],ho={class:"flex-1 flex flex-col justify-between ml-20px text-24px"},po={class:"text-38px"},go={key:1,class:"invisible text-[#029AA7] bg-[#DDF6F8] px-8px py-4px mr-8px"},vo={class:"text-20px mt-9px mb-5px text-[#30F230]"},_o={class:"text-26px"},xo={class:"text-[#888]"},it=j({__name:"infoList",props:{info:{}},emits:["toDetail"],setup(e,{emit:t}){const n=e,s=K(()=>{var f;return!((f=n.info)!=null&&f.businessStatus&&n.info.businessStatus=="1")}),a=K(()=>{var f;return(f=n.info)!=null&&f.tag?JSON.parse(n.info.tag):[]}),l=t,u=()=>{l("toDetail",n.info)};return(f,i)=>{var r,v,C,_,x,T;const m=nt;return y(),L("div",{class:ce(["flex w-100%",[(r=n.info)!=null&&r.h?n.info.h:""]]),onClick:i[1]||(i[1]=V=>u())},[p("div",fo,[p("div",{class:ce([[c(s)?"bg-#029AA7":"bg-#888"],"absolute left-0 top-0 z-1 w-100px py-4px text-center text-#fff text-24px rounded-tl-4px rounded-br-4px"])},H(c(s)?"营业中":"歇业中"),3),h(m,{class:"w-228px",height:n.info.imgH,fit:"cover",src:c(De)((v=n.info)==null?void 0:v.thumb)??c(U)("editSrc.png"),"lazy-load":""},null,8,["height","src"]),(C=n.info)!=null&&C.vrimage?(y(),L("img",{key:0,onClick:i[0]||(i[0]=At(V=>c(he)("webView",n.info.vrimage,!0),["stop"])),class:"absolute right-12px bottom-12px z-1 w-40px h-40px",src:c(U)("icon-vr.png")},null,8,mo)):ge("",!0)]),p("div",ho,[p("div",po,H(((_=n.info)==null?void 0:_.name)??""),1),p("div",null,[c(a).length>0?(y(!0),L(q,{key:0},Z(c(a).slice(0,3),V=>(y(),L("span",{key:V,class:"text-[#029AA7] bg-[#DDF6F8] px-8px py-4px mr-8px"},H(V),1))),128)):(y(),L("span",go,"问问"))]),p("div",vo,[i[2]||(i[2]=pe(" ￥")),p("span",_o,H(((x=n.info)==null?void 0:x.price)??"600"),1),i[3]||(i[3]=pe("/晚 "))]),p("div",xo,H(((T=n.info)==null?void 0:T.lcposition)??""),1)])],2)}}}),bo={class:"py-20px px-30px box-border"},yo=j({__name:"detailInfo",props:{showInfo:{type:Boolean},detailInfo:{}},emits:["update:showInfo"],setup(e,{emit:t}){const n=e,s=w();oe(()=>n.detailInfo,f=>{a(f.id)});const a=async f=>{const i=await Qt(f);s.value=i},l=t,u=()=>l("update:showInfo",!1);return(f,i)=>{const m=Yt,r=Qe;return y(),be(r,{show:f.showInfo,closeable:"","close-icon":"close",round:"",position:"bottom",class:"min-h-max",onClickOverlay:u,onClickCloseIcon:u},{default:Q(()=>[p("div",bo,[h(it,{info:{...c(s),h:"h-181px",imgH:"100px"},onToDetail:i[0]||(i[0]=v=>c(he)("detail",v.id))},null,8,["info"]),h(m,{info:{...c(s),cla:"mt-34px"}},null,8,["info"])])]),_:1},8,["show"])}}});const wo=se(yo,[["__scopeId","data-v-6c00acfc"]]),ko={class:"popup-top"},Co=["src"],qe="overflow-hidden",Io=j({__name:"FloatingPanel",props:{maxHeight:{default:98},firstHeight:{default:50},minHeight:{default:8},isNeedTwo:{type:Boolean,default:!0}},emits:["change","handleScroll"],setup(e,{expose:t,emit:n}){const s=e;let a=0,l=0;const u=w(s.minHeight),f=w(null),i=w(0),m=w(!1),r=n,v=K(()=>({height:u.value==s.maxHeight?"calc(100% - 120px)":u.value+"%",overflowY:u.value>50?"auto":"hidden"})),C=D=>{m.value=!0,a=D.touches[0].clientY},_=D=>{if(i.value!==0)return;m.value=!1;const M=D.changedTouches[0].clientY-a;Math.abs(M)<5||(s.isNeedTwo?M<0?l==0?(l=1,u.value=s.firstHeight):(l=2,u.value=s.maxHeight):l==2&&M>20&&M<200?(l=1,u.value=s.firstHeight):(l==2&&M>200||l==1&&M>5)&&(l=0,u.value=s.minHeight):u.value=M<0?s.maxHeight:s.minHeight,a=0,r("change",u.value))},x=()=>{u.value=s.minHeight,i.value=0,l=0,r("change",u.value)},T=()=>{var D,M;i.value=(D=f.value)!=null&&D.scrollTop&&((M=f.value)==null?void 0:M.scrollTop)>0?f.value.scrollTop:0,r("handleScroll",i.value)};xe(()=>{window.addEventListener("scroll",T,!0)});const V=()=>{document.body.classList.add(qe)},$=()=>{document.body.classList.remove(qe)};return oe(m,D=>{D?V():$()}),t({hideDialog:x}),(D,M)=>(y(),L("div",{ref_key:"popup",ref:f,class:"popup",style:Ye([c(v)]),onTouchstart:C,onTouchend:_},[p("div",ko,[p("img",{class:"w-64px h-18px",src:c(U)(c(u)==s.maxHeight?"icon-xh.png":"icon-sh.png")},null,8,Co)]),M[0]||(M[0]=p("div",{class:"w-100% h-1px mb-15px bg-[#ddd]"},null,-1)),Je(D.$slots,"default",{},void 0,!0)],36))}});const So=se(Io,[["__scopeId","data-v-bcccb6c4"]]);const Lo={class:"px-28px"},To={key:0,class:"container bg-#fff rounded-10px"},$o=["src"],Mo={key:1,class:"text-center text-[#ddd]"},Bo=j({__name:"floatFooter",props:{markerData:{}},emits:["toDetail"],setup(e,{emit:t}){const n=e,s=w();oe(()=>n.markerData,u=>{s.value=u});const a=t,l=u=>{a("toDetail",u)};return(u,f)=>{const i=Cn,m=So;return y(),be(m,{"min-height":20,"max-height":79,"is-need-two":!1},{default:Q(()=>{var r;return[p("div",Lo,[((r=c(s))==null?void 0:r.length)>0?(y(),L("div",To,[(y(!0),L(q,null,Z(c(s),v=>(y(),L("div",{key:v.id},[h(it,{info:{...v,h:"h-172px",imgH:"100%"},onToDetail:l},null,8,["info"]),f[0]||(f[0]=p("div",{class:"my-20px h-2px w-full bg-[#ddd]"},null,-1))]))),128)),h(i,{target:".popup",right:"40px",bottom:"128px","z-index":"2002",style:{"background-color":"transparent"}},{default:Q(()=>[p("img",{class:"w-84px h-84px",src:c(U)("back-top.png")},null,8,$o)]),_:1})])):(y(),L("div",Mo,"暂无数据"))])]}),_:1})}}});const Vo=se(Bo,[["__scopeId","data-v-f30f1191"]]),X=window.TMap,Ao=e=>{window.document.title=e.name;const t=new X.Map("container",{zoom:(e==null?void 0:e.mapZoom)??17,center:new X.LatLng(JSON.parse(e.mapCenter)[0],JSON.parse(e.mapCenter)[1]),renderOptions:{enableBloom:!0},baseMap:{type:"vector",features:["base","point","label","arrow"]},viewMode:"2D"}),n={}.VITE_BASE_LAUNCH_URL+e.layerUrl,s=new X.LatLng(JSON.parse(e.imageSW)[0],JSON.parse(e.imageSW)[1]),a=new X.LatLng(JSON.parse(e.imageNE)[0],JSON.parse(e.imageNE)[1]),l=new X.LatLngBounds(s,a),u=new X.ImageGroundLayer({bounds:l,src:n,map:t});return window.imageGroundLayer=u,Do(t),{map:t}},Do=e=>{e.removeControl(X.constants.DEFAULT_CONTROL_ID.ZOOM),e.removeControl(X.constants.DEFAULT_CONTROL_ID.ROTATION)},Po={class:"w-screen h-screen overflow-hidden"},Eo={class:"search-result"},Oo=["onClick"],Ro={class:"px-16px pt-32px"},Fo={class:"flex justify-between"},jo={class:"font-extrabold text-30px text-#353535 flex items-center"},No=["src"],zo={class:"text-20px text-#888 flex flex-col justify-center items-center"},Ho=["src"],Uo=["src"],Qo=j({__name:"index",setup(e){const t=w(),n=w(),s=w(!1),a=w(!0),l=w(!0),u=w(!1),f=w([]),i=w(null),m=w(),r=w([{name:"全部",id:0}]);let v,C,_;const x=async()=>{_=tt.getCache("ruralInfo"),m.value=await d(),{map:v}=Ao(_),window.map=v,window.mapPlugins=C=Be(v,m.value),v.on("click",()=>{a.value=!l.value,l.value=!l.value,n.value.showPopup=!1}),Ie(C,b=>$(b))},T=nn(async b=>{f.value=b?m.value:[]},500),V=async b=>{m.value=b.id=="0"?await d():await k([{...b}]),ee()},$=b=>{var B,P,g,N;s.value=!0,a.value=!1,u.value=!1,i.value=(b==null?void 0:b.geometry)??b,ze(v,_==null?void 0:_.markerZoom,[((P=(B=i.value)==null?void 0:B.position)==null?void 0:P.lat)??i.value.latitude,((N=(g=i.value)==null?void 0:g.position)==null?void 0:N.lng)??i.value.longitude])},D=()=>{ze(v,_==null?void 0:_.mapZoom,[JSON.parse(_.mapCenter)[0],JSON.parse(_.mapCenter)[1]])},M=(b,B)=>{l.value&&(a.value=!b),!b&&B=="tjlx"&&(C=Be(v,m.value),Ie(C,P=>$(P)))},ee=()=>{lt(C),C=Be(v,m.value),Ie(C,b=>$(b))},d=async()=>(r.value=[{name:"全部",id:0}],(await en()).filter(P=>{r.value.push({id:P.id,name:P.name,icon:P.icon})}),await k(r.value)),k=async b=>{const B=[];for(const g in b)B.push(tn(b[g].id));const P=await Promise.all([...B]);return b.forEach((g,N)=>{P[N].filter(de=>{de.icon=(g==null?void 0:g.icon)??null})}),P.flat()},R=b=>{s.value=b,a.value=!1,l.value=!1};return xe(()=>{x()}),(b,B)=>{const P=Vn;return y(),L("div",Po,[le(p("div",null,[h(P,{onSearch:c(T),onFocus:B[0]||(B[0]=g=>u.value=!0),onClear:B[1]||(B[1]=g=>u.value=!1)},null,8,["onSearch"]),h(Fn,{ref_key:"topRef",ref:t,class:"classification","marker-type":c(r),onTypeClick:V},null,8,["marker-type"]),h(uo,{ref_key:"refToolBar",ref:n,onLineRoad:$,onShowFooter:M},null,512)],512),[[ie,c(l)]]),B[5]||(B[5]=p("div",{class:"w-screen h-screen",id:"container"},null,-1)),h(wo,{detailInfo:c(i),"show-info":c(s),"onUpdate:showInfo":R},null,8,["detailInfo","show-info"]),le(h(Vo,{"marker-data":c(m),onToDetail:$},null,8,["marker-data"]),[[ie,c(a)]]),le(p("div",Eo,[c(f).length>0?(y(!0),L(q,{key:0},Z(c(f),g=>(y(),L("div",{onClick:N=>$(g),key:g.id,class:"mb-10px"},[B[3]||(B[3]=p("div",{class:"text-30px text-#029AA7 mb-24px"},"景区",-1)),B[4]||(B[4]=p("div",{class:"line"},null,-1)),p("div",Ro,[p("div",Fo,[p("div",jo,[p("img",{class:"w-60px h-68px mr-21px",src:c(U)("cluster-bubble.png")},null,8,No),pe(H(g.name),1)]),p("div",zo,[p("img",{class:"w-48px h-48px mb-8px",src:c(U)("icon-dzq.png")},null,8,Ho),B[2]||(B[2]=pe("到这去 "))])])])],8,Oo))),128)):ge("",!0)],512),[[ie,c(u)]]),le(p("img",{onClick:D,class:"location",src:c(U)("position.png")},null,8,Uo),[[ie,!c(l)]])])}}});export{Qo as default};
